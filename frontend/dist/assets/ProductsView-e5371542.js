import{d as G,u as H,a as K,r as l,k as W,o as X,c as n,b as e,t as c,l as p,v as R,m as q,F as I,f as M,q as Q,j as g,n as P,s as Y,x as Z,y as ee,p as te,g as se,h as o,e as ae,w as oe,i as le,z as ne}from"./index-c65d1cd2.js";import{_ as ie}from"./ProductModal.vue_vue_type_script_setup_true_lang-4b49ce0c.js";const re={class:"products-view"},ce={class:"container mx-auto px-4 py-8"},ue={class:"flex justify-between items-center mb-8"},de={class:"text-sm text-gray-600"},me={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},ve={class:"lg:col-span-1"},pe={class:"card sticky top-4"},ge={class:"card-body space-y-6"},fe=["value"],ye={class:"text-sm text-gray-600 mt-1"},xe={class:"flex items-center"},be={class:"flex items-center"},he={class:"lg:col-span-3"},ke={class:"flex justify-between items-center mb-6"},we={class:"flex items-center space-x-4"},_e={key:0,class:"text-center py-12"},Pe={key:1,class:"grid grid-cols-1 gap-x-8 gap-y-8 sm:grid-cols-2 sm:gap-y-10 lg:grid-cols-3"},Ce={class:"relative"},Se=["src","alt"],Ve={key:0,class:"absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded text-xs font-bold"},Te={key:1,class:"absolute top-2 right-2 bg-orange-500 text-white px-2 py-1 rounded text-xs"},Ae={key:2,class:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded text-xs"},je={"aria-hidden":"true",class:"absolute inset-0 flex items-end p-4 opacity-0 group-hover:opacity-100 transition-opacity"},Ee=["onClick"],Ne={class:"mt-4 flex items-center justify-between space-x-8 text-base font-medium text-gray-900"},Oe={class:"flex items-center space-x-2"},Re={key:0,class:"text-orange-600 font-bold"},qe={class:"mt-1 text-sm text-gray-500"},Ie=["onClick","disabled"],Me={key:2,class:"text-center py-16"},Qe={key:3,class:"flex justify-center mt-8"},Ue={class:"flex space-x-2"},Be=["disabled"],Fe={class:"flex items-center px-4 py-2 text-sm text-gray-600"},$e=["disabled"],ze=12,Ge=G({__name:"ProductsView",setup(De){const U=Z(),B=H(),C=K(),x=l([]),_=l([]),b=l(!0),h=l(null),f=l(""),d=l(""),m=l(2e3),k=l(!1),w=l(!1),y=l("name"),i=l(1),S=l(0),v=l(0),V={chaussures:"https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=500&h=500&fit=crop",musculation:"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=500&h=500&fit=crop","yoga-pilates":"https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=500&h=500&fit=crop","electronique-sport":"https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=500&h=500&fit=crop",accessoires:"https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=500&h=500&fit=crop",nutrition:"https://images.unsplash.com/photo-1593095948071-474c5cc2989d?w=500&h=500&fit=crop",cardio:"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=500&h=500&fit=crop","sports-combat":"https://images.unsplash.com/photo-1549719386-74dfcbf7dbed?w=500&h=500&fit=crop"};let T;const F=()=>{clearTimeout(T),T=setTimeout(()=>{i.value=1,r()},500)},$=async()=>{try{const s=await ee.getCategories();s.success&&s.data&&(_.value=s.data)}catch(s){console.error("Erreur lors du chargement des catégories:",s),C.error("Erreur lors du chargement des catégories")}},r=async()=>{b.value=!0;try{const s={page:i.value,limit:ze,sortBy:y.value==="newest"?"createdAt":y.value,sortOrder:y.value==="price-desc"?"desc":"asc"};f.value&&(s.search=f.value),d.value&&(s.category=d.value),m.value<2e3&&(s.maxPrice=m.value),k.value&&(s.onSale=!0),w.value&&(s.inStock=!0);const t=await te.getProducts(s);t.success&&t.data&&(x.value=t.data.products||[],t.data.pagination&&(S.value=t.data.pagination.total,v.value=t.data.pagination.pages))}catch(s){console.error("Erreur lors du chargement des produits:",s),C.error("Erreur lors du chargement des produits"),x.value=[]}finally{b.value=!1}},A=s=>{var u;const t=((u=s.category)==null?void 0:u.slug)||"accessoires";return V[t]||V.accessoires},j=async s=>{var u,a;const t={_id:s.id.toString(),name:s.name,description:s.description,price:s.isOnSale&&s.salePrice?s.salePrice:s.price,salePrice:s.salePrice,isOnSale:s.isOnSale,images:[{url:A(s),alt:s.name,isPrimary:!0}],category:{id:s.categoryId.toString(),name:((u=s.category)==null?void 0:u.name)||"Sport",slug:((a=s.category)==null?void 0:a.slug)||"sport"},stock:{quantity:s.stockQuantity,reserved:0,lowStockThreshold:5},slug:s.slug||s.name.toLowerCase().replace(/\s+/g,"-"),status:"active",isActive:!0,rating:{average:4.5,count:100},salesCount:50,createdAt:s.createdAt,updatedAt:s.updatedAt};await B.addItem(t,1)},z=s=>{h.value=s},E=()=>{f.value="",d.value="",m.value=2e3,k.value=!1,w.value=!1,i.value=1,r()},D=()=>{i.value<v.value&&(i.value++,r())},L=()=>{i.value>1&&(i.value--,r())},N=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(s);return W(()=>U.query.category,s=>{if(s){const t=_.value.find(u=>u.slug===s);t&&(d.value=t.id.toString(),r())}},{immediate:!0}),X(async()=>{await $(),await r()}),(s,t)=>{const u=se("router-link");return o(),n("div",re,[e("div",ce,[e("div",ue,[t[7]||(t[7]=e("h1",{class:"text-3xl font-bold text-gray-900"},"Nos Produits",-1)),e("div",de,c(S.value)+" produit(s) trouvé(s) ",1)]),e("div",me,[e("div",ve,[e("div",pe,[t[14]||(t[14]=e("div",{class:"card-header"},[e("h2",{class:"text-lg font-semibold"},"Filtres")],-1)),e("div",ge,[e("div",null,[t[8]||(t[8]=e("label",{class:"form-label"},"Rechercher",-1)),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>f.value=a),type:"text",placeholder:"Nom du produit...",class:"form-input",onInput:F},null,544),[[R,f.value]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"form-label"},"Catégorie",-1)),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>d.value=a),class:"form-select",onChange:r},[t[9]||(t[9]=e("option",{value:""},"Toutes les catégories",-1)),(o(!0),n(I,null,M(_.value,a=>(o(),n("option",{key:a.id,value:a.id},c(a.name),9,fe))),128))],544),[[q,d.value]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"form-label"},"Prix maximum",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>m.value=a),type:"range",min:"0",max:"2000",step:"50",class:"w-full",onChange:r},null,544),[[R,m.value,void 0,{number:!0}]]),e("div",ye," Jusqu'à "+c(m.value)+"€ ",1)]),e("div",null,[e("label",xe,[p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>k.value=a),type:"checkbox",class:"mr-2",onChange:r},null,544),[[Q,k.value]]),t[12]||(t[12]=e("span",{class:"text-sm"},"Promotions uniquement",-1))])]),e("div",null,[e("label",be,[p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>w.value=a),type:"checkbox",class:"mr-2",onChange:r},null,544),[[Q,w.value]]),t[13]||(t[13]=e("span",{class:"text-sm"},"En stock uniquement",-1))])]),e("button",{onClick:E,class:"btn btn-outline w-full"}," Réinitialiser les filtres ")])])]),e("div",he,[e("div",ke,[e("div",we,[t[16]||(t[16]=e("span",{class:"text-sm text-gray-600"},"Trier par :",-1)),p(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>y.value=a),class:"form-select",onChange:r},t[15]||(t[15]=[e("option",{value:"name"},"Nom",-1),e("option",{value:"price"},"Prix croissant",-1),e("option",{value:"price-desc"},"Prix décroissant",-1),e("option",{value:"newest"},"Plus récent",-1)]),544),[[q,y.value]])])]),b.value?(o(),n("div",_e,t[17]||(t[17]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"},null,-1),e("p",{class:"mt-2"},"Chargement des produits...",-1)]))):x.value.length>0?(o(),n("div",Pe,[(o(!0),n(I,null,M(x.value,a=>{var O;return o(),n("div",{key:a.id,class:"group relative"},[e("div",Ce,[e("img",{src:A(a),alt:a.name,class:"aspect-[4/3] w-full rounded-lg bg-gray-100 object-cover"},null,8,Se),a.isOnSale&&a.salePrice?(o(),n("div",Ve," -"+c(Math.round((a.price-a.salePrice)/a.price*100))+"% ",1)):g("",!0),a.stockQuantity<=5&&a.stockQuantity>0?(o(),n("div",Te," Stock faible ")):a.stockQuantity===0?(o(),n("div",Ae," Rupture ")):g("",!0),e("div",je,[e("div",{onClick:J=>z(a),class:"w-full rounded-md bg-white/75 px-4 py-2 text-center text-sm font-medium text-gray-900 backdrop-blur backdrop-filter cursor-pointer hover:bg-white/90"}," Voir le produit ",8,Ee)])]),e("div",Ne,[e("h3",null,[ae(u,{to:`/products/${a.id}`,class:"hover:text-orange-600"},{default:oe(()=>[t[18]||(t[18]=e("span",{"aria-hidden":"true",class:"absolute inset-0"},null,-1)),le(" "+c(a.name),1)]),_:2,__:[18]},1032,["to"])]),e("div",Oe,[a.isOnSale&&a.salePrice?(o(),n("span",Re,c(N(a.salePrice)),1)):g("",!0),e("span",{class:P(a.isOnSale&&a.salePrice?"line-through text-gray-400 text-sm":"text-orange-600 font-bold")},c(N(a.price)),3)])]),e("p",qe,c(((O=a.category)==null?void 0:O.name)||"Sport"),1),e("button",{onClick:ne(J=>j(a),["stop"]),disabled:!a.stockQuantity,class:"mt-3 w-full bg-orange-600 text-white py-2 px-4 rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},c(a.stockQuantity?"Ajouter au panier":"Rupture de stock"),9,Ie)])}),128))])):b.value?g("",!0):(o(),n("div",Me,[t[19]||(t[19]=e("div",{class:"w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center"},[e("span",{class:"text-4xl"},"🔍")],-1)),t[20]||(t[20]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Aucun produit trouvé",-1)),t[21]||(t[21]=e("p",{class:"text-gray-600 mb-6"},"Essayez de modifier vos critères de recherche",-1)),e("button",{onClick:E,class:"px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg hover:from-orange-600 hover:to-red-700 transition-all"}," Réinitialiser les filtres ")])),v.value>1?(o(),n("div",Qe,[e("div",Ue,[e("button",{onClick:L,disabled:i.value===1,class:P(["btn btn-outline",{"opacity-50 cursor-not-allowed":i.value===1}])}," Précédent ",10,Be),e("span",Fe," Page "+c(i.value)+" sur "+c(v.value),1),e("button",{onClick:D,disabled:i.value===v.value,class:P(["btn btn-outline",{"opacity-50 cursor-not-allowed":i.value===v.value}])}," Suivant ",10,$e)])])):g("",!0)])])]),h.value?(o(),Y(ie,{key:0,product:h.value,onClose:t[6]||(t[6]=a=>h.value=null),onAddToCart:j},null,8,["product"])):g("",!0)])}}});export{Ge as default};
//# sourceMappingURL=ProductsView-e5371542.js.map
