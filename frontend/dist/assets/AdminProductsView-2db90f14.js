import{d as H,a as J,r,o as K,G as k,c as l,b as e,t as o,e as V,w as j,l as C,v as W,m as B,F as L,f as D,n as v,j as h,s as X,p as E,y as Y,g as Z,h as i,i as M}from"./index-c65d1cd2.js";import{_ as ee}from"./ProductModal.vue_vue_type_script_setup_true_lang-4b49ce0c.js";const te={class:"admin-products"},se={class:"container mx-auto px-4 py-8"},ae={class:"flex justify-between items-center mb-8"},oe={class:"text-gray-600"},ie={class:"card mb-6"},le={class:"card-body"},ne={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},re=["value"],ce={key:0,class:"text-center py-12"},de={key:1,class:"card"},ue={class:"overflow-x-auto"},ve={class:"min-w-full divide-y divide-gray-200"},ge={class:"bg-white divide-y divide-gray-200"},xe={class:"px-6 py-4 whitespace-nowrap"},me={class:"flex items-center"},pe={class:"flex-shrink-0 h-12 w-12"},ye=["src","alt"],fe={class:"ml-4"},_e={class:"text-sm font-medium text-gray-900"},he={class:"text-sm text-gray-500"},be={class:"px-6 py-4 whitespace-nowrap"},we={class:"text-sm text-gray-900"},ke={class:"px-6 py-4 whitespace-nowrap"},Ce={class:"text-sm text-gray-900"},Ae={key:0,class:"text-red-500 font-bold"},Se={class:"px-6 py-4 whitespace-nowrap"},$e={class:"px-6 py-4 whitespace-nowrap"},Te={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ve={class:"flex space-x-2"},je=["onClick"],Be=["onClick","title"],Le=["onClick"],De={key:2,class:"flex justify-center mt-6"},Ee={class:"flex space-x-2"},Me=["disabled"],Ne={class:"flex items-center px-4 py-2 text-sm text-gray-600"},Fe=["disabled"],Pe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ie={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Ue={class:"text-gray-600 mb-6"},qe={class:"flex space-x-3"},A=10,Qe=H({__name:"AdminProductsView",setup(ze){const d=J(),b=r([]),S=r([]),w=r(!0),f=r(null),c=r(null),u=r(""),g=r(""),x=r(""),n=r(1);function N(t){var s,m,a,p,y;return{...t,_id:((s=t.id)==null?void 0:s.toString())??"",images:Array.isArray(t.images)?t.images:[],stock:{quantity:t.stockQuantity??0,reserved:((m=t.stock)==null?void 0:m.reserved)??0,lowStockThreshold:((a=t.stock)==null?void 0:a.lowStockThreshold)??5},category:t.category?{id:((p=t.category.id)==null?void 0:p.toString())??"",name:t.category.name??"",slug:t.category.slug??"",description:t.category.description??"",isActive:t.category.isActive??!0,createdAt:t.category.createdAt??"",updatedAt:t.category.updatedAt??""}:{id:((y=t.categoryId)==null?void 0:y.toString())??"",name:"",slug:"",description:"",isActive:!0,createdAt:"",updatedAt:""},status:t.status??"active",isActive:t.isActive??!0,rating:t.rating??{average:0,count:0},salesCount:t.salesCount??0}}const $=async()=>{var t;w.value=!0;try{const s=await E.getProducts();b.value=(((t=s.data)==null?void 0:t.products)||[]).map(N)}catch{d.error("Erreur lors du chargement des produits")}finally{w.value=!1}},F=async()=>{try{const t=await Y.getCategories();t.success&&t.data&&(S.value=t.data)}catch{d.error("Erreur lors du chargement des catégories")}};K(async()=>{await F(),await $()});const T=k(()=>{let t=b.value;return u.value&&(t=t.filter(s=>s.name.toLowerCase().includes(u.value.toLowerCase())||s.description.toLowerCase().includes(u.value.toLowerCase()))),g.value&&(t=t.filter(s=>String(s.category.id)===String(g.value))),x.value&&(t=t.filter(s=>s.status===x.value)),t}),_=k(()=>Math.ceil(T.value.length/A)),P=k(()=>{const t=(n.value-1)*A,s=t+A;return T.value.slice(t,s)}),I=t=>t===0?"bg-red-100 text-red-800":t<=5?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800",U=t=>{switch(t){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-red-100 text-red-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},q=t=>{switch(t){case"active":return"Actif";case"inactive":return"Inactif";case"draft":return"Brouillon";default:return t}},z=t=>{f.value=t},G=async t=>{try{t.isActive=!t.isActive,t.status=t.isActive?"active":"inactive",d.success(`Produit ${t.isActive?"activé":"désactivé"} avec succès`)}catch{d.error("Erreur lors de la modification du statut")}},O=t=>{c.value=t},Q=async()=>{if(c.value)try{await E.deleteProduct(c.value._id),await $(),d.success("Produit supprimé avec succès"),c.value=null}catch{d.error("Erreur lors de la suppression")}},R=()=>{u.value="",g.value="",x.value="",n.value=1};return(t,s)=>{const m=Z("router-link");return i(),l("div",te,[e("div",se,[e("div",ae,[e("div",null,[s[7]||(s[7]=e("h1",{class:"text-3xl font-bold text-gray-900"},"Gestion des Produits",-1)),e("p",oe,o(b.value.length)+" produit(s) au total",1)]),V(m,{to:"/admin/products/new",class:"btn btn-primary"},{default:j(()=>s[8]||(s[8]=[M(" ➕ Nouveau produit ")])),_:1,__:[8]})]),e("div",ie,[e("div",le,[e("div",ne,[e("div",null,[C(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>u.value=a),type:"text",placeholder:"Rechercher un produit...",class:"form-input"},null,512),[[W,u.value]])]),e("div",null,[C(e("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>g.value=a),class:"form-select"},[s[9]||(s[9]=e("option",{value:""},"Toutes les catégories",-1)),(i(!0),l(L,null,D(S.value,a=>(i(),l("option",{key:a.id,value:a.id},o(a.name),9,re))),128))],512),[[B,g.value]])]),e("div",null,[C(e("select",{"onUpdate:modelValue":s[2]||(s[2]=a=>x.value=a),class:"form-select"},s[10]||(s[10]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1),e("option",{value:"draft"},"Brouillon",-1)]),512),[[B,x.value]])]),e("div",null,[e("button",{onClick:R,class:"btn btn-outline w-full"}," Réinitialiser ")])])])]),w.value?(i(),l("div",ce,s[11]||(s[11]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-2"},"Chargement des produits...",-1)]))):(i(),l("div",de,[e("div",ue,[e("table",ve,[s[13]||(s[13]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Catégorie "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Prix "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Stock "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",ge,[(i(!0),l(L,null,D(P.value,a=>{var p;return i(),l("tr",{key:a._id,class:"hover:bg-gray-50"},[e("td",xe,[e("div",me,[e("div",pe,[e("img",{src:((p=a.images[0])==null?void 0:p.url)||"/placeholder.jpg",alt:a.name,class:"h-12 w-12 rounded-lg object-cover"},null,8,ye)]),e("div",fe,[e("div",_e,o(a.name),1),e("div",he,o(a.slug),1)])])]),e("td",be,[e("span",we,o(a.category.name),1)]),e("td",ke,[e("div",Ce,[a.isOnSale?(i(),l("span",Ae,o(a.salePrice)+"€ ",1)):h("",!0),e("span",{class:v(a.isOnSale?"line-through text-gray-400 ml-2":"font-medium")},o(a.price)+"€ ",3)])]),e("td",Se,[e("span",{class:v(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",I(a.stock.quantity)])},o(a.stock.quantity)+" unités ",3)]),e("td",$e,[e("span",{class:v(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",U(a.status??"")])},o(q(a.status??"")),3)]),e("td",Te,[e("div",Ve,[e("button",{onClick:y=>z(a),class:"text-blue-600 hover:text-blue-900",title:"Voir"}," 👁️ ",8,je),V(m,{to:`/admin/products/${a._id}/edit`,class:"text-indigo-600 hover:text-indigo-900",title:"Modifier"},{default:j(()=>s[12]||(s[12]=[M(" ✏️ ")])),_:2,__:[12]},1032,["to"]),e("button",{onClick:y=>G(a),class:v(a.isActive?"text-orange-600 hover:text-orange-900":"text-green-600 hover:text-green-900"),title:a.isActive?"Désactiver":"Activer"},o(a.isActive?"⏸️":"▶️"),11,Be),e("button",{onClick:y=>O(a),class:"text-red-600 hover:text-red-900",title:"Supprimer"}," 🗑️ ",8,Le)])])])}),128))])])])])),_.value>1?(i(),l("div",De,[e("div",Ee,[e("button",{onClick:s[3]||(s[3]=a=>n.value--),disabled:n.value===1,class:v(["btn btn-outline",{"opacity-50 cursor-not-allowed":n.value===1}])}," Précédent ",10,Me),e("span",Ne," Page "+o(n.value)+" sur "+o(_.value),1),e("button",{onClick:s[4]||(s[4]=a=>n.value++),disabled:n.value===_.value,class:v(["btn btn-outline",{"opacity-50 cursor-not-allowed":n.value===_.value}])}," Suivant ",10,Fe)])])):h("",!0)]),c.value?(i(),l("div",Pe,[e("div",Ie,[s[14]||(s[14]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirmer la suppression",-1)),e("p",Ue,' Êtes-vous sûr de vouloir supprimer le produit "'+o(c.value.name)+'" ? Cette action est irréversible. ',1),e("div",qe,[e("button",{onClick:s[5]||(s[5]=a=>c.value=null),class:"btn btn-outline flex-1"}," Annuler "),e("button",{onClick:Q,class:"btn btn-danger flex-1"}," Supprimer ")])])])):h("",!0),f.value?(i(),X(ee,{key:1,product:f.value,onClose:s[6]||(s[6]=a=>f.value=null),onAddToCart:()=>{}},null,8,["product"])):h("",!0)])}}});export{Qe as default};
//# sourceMappingURL=AdminProductsView-2db90f14.js.map
